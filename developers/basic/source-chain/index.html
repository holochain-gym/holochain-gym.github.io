<!DOCTYPE html><html lang="en" dir="ltr"><head>
  
    

  



<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic: Source chain: Holochain Gym</title>
<meta property="og:title" content="Basic: Source chain: Holochain Gym">

<meta name="generator" content="rocket 0.1">
<link rel="canonical" href="/developers/basic/source-chain/">



<meta name="description" content="Holochain Gym contains exercises, resources and trainings to learn holochain">
<meta property="og:description" content="Holochain Gym contains exercises, resources and trainings to learn holochain">

  
    <link rel="apple-touch-icon" sizes="180x180" href="../../../assets/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../assets/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../assets/favicon-16x16.png">
<link rel="manifest" href="../../../assets/webmanifest.json">
<link rel="mask-icon" href="../../../assets/safari-pinned-tab.svg" color="#3f93ce">
<meta name="msapplication-TileColor" content="#1d3557">
<meta name="theme-color" content="#1d3557">

  
    <meta property="og:site_name" content="Holochain Gym">
<meta property="og:type" content="website">

<meta property="og:image" content="../../../cd9dea3f.png">
<meta property="og:url" content="/developers/basic/source-chain/">

<meta name="twitter:card" content="summary_large_image">

  
    <link rel="stylesheet" href="../../../99c99f60.css">
<link rel="stylesheet" href="../../../490f016e.css">
<link rel="stylesheet" href="../../../a0513237.css">
<link rel="stylesheet" href="../../../b8c01bc2.css">

  
    <noscript><link rel="stylesheet" href="/_merged_assets/_static/noscript.css"/></noscript>

  

<link rel="preload" href="../../../da0cf761.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../e47816b7.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../ba1498b4.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../17157e21.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../962426a7.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../3290032f7.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../2b1864b5.js" as="script" crossorigin="anonymous">
</head>

  

  
  <body layout="layout-sidebar">
  

    
      <header id="main-header">
  <div class="content-area">
    
      <button id="mobile-menu-trigger" data-action="trigger-mobile-menu">
	<span class="sr-only">Show Menu</span>
	      <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon">
        <path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path>
      </svg>

</button>

    
      
	<a class="logo-link" href="/">
  <img src="../../../a9d80dbb.svg" alt="A gym tool">
  <span>Holochain Gym</span>
</a>



    
      
  <a href="/architects/" class="
          
          
        "></a>
  <a href="/developers/" class="
          
           active 
        ">Developers</a>

    
      <a href="https://developer.holochain.org/docs/concepts/" class="">Core Concepts</a>
    
      <launch-dark-switch class="light-dark-switch" label="Toggle darkmode">Toggle darkmode</launch-dark-switch>


    
      <a href="https://developer.holochain.org/docs/glossary/" class="">Glossary of Terms</a>
    
      <a href="https://forum.holochain.org/c/learning-library/gym/133" class="">Give us Feedback!</a>
    
      
	<a class="social-link" href="https://github.com/holochain-gym/" aria-label="Holochain Gym on GitHub" rel="noopener noreferrer" target="_blank">
		<span class="sr-only">GitHub</span>
		
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 16" fill="none">
  <title>GitHub</title>
  <path fill="currentColor" fill-rule="evenodd" d="M8.18391.249268C3.82241.249268.253906 3.81777.253906 8.17927c0 3.46933 2.279874 6.44313 5.451874 7.53353.3965.0991.49563-.1983.49563-.3965v-1.3878c-2.18075.4956-2.67638-.9912-2.67638-.9912-.3965-.8922-.89212-1.1895-.89212-1.1895-.69388-.4957.09912-.4957.09912-.4957.793.0992 1.1895.793 1.1895.793.69388 1.2887 1.88338.8922 2.27988.6939.09912-.4956.29737-.8921.49562-1.0904-1.78425-.1982-3.5685-.8921-3.5685-3.96496 0-.89212.29738-1.586.793-2.08162-.09912-.19825-.3965-.99125.09913-2.08163 0 0 .69387-.19825 2.18075.793.59475-.19825 1.28862-.29737 1.9825-.29737.69387 0 1.38775.09912 1.98249.29737 1.4869-.99125 2.1808-.793 2.1808-.793.3965 1.09038.1982 1.88338.0991 2.08163.4956.59475.793 1.28862.793 2.08162 0 3.07286-1.8834 3.66766-3.66764 3.86586.29737.3965.59474.8921.59474 1.586v2.1808c0 .1982.0991.4956.5948.3965 3.172-1.0904 5.4518-4.0642 5.4518-7.53353-.0991-4.3615-3.6676-7.930002-8.02909-7.930002z" clip-rule="evenodd"></path>
</svg>

		
	</a>

    
  </div>
</header>

    

    
  <div id="content-wrapper">
    <div class="content-area">
      
        <rocket-drawer id="sidebar">
  <nav slot="content" id="sidebar-nav">
    
      <a class="logo-link" href="/">
  <img src="../../../a9d80dbb.svg" alt="A gym tool">
  <span>Holochain Gym</span>
</a>


    
      <rocket-navigation>
  <ul><li class="menu-item">
<a href="/developers/requirements/">Requirements</a>
<ul><li class="menu-item">
<a href="/developers/requirements/setup/">Setup</a>

</li>
<li class="menu-item">
<a href="/developers/requirements/documentation/">Documentation</a>

</li>
<li class="menu-item">
<a href="/developers/requirements/rust/">Rust</a>

</li>
<li class="menu-item">
<a href="/developers/requirements/anatomy/">Anatomy</a>

</li></ul>
</li>
<li class="menu-item active">
<a href="/developers/basic/">Basic</a>
<ul><li class="menu-item">
<a href="/developers/basic/entries/">Entries</a>

</li>
<li class="menu-item">
<a href="/developers/basic/hashes/">Hashes</a>

</li>
<li class="menu-item">
<a href="/developers/basic/links/">Links</a>

</li>
<li class="menu-item">
<a href="/developers/basic/headers/">Headers</a>

</li>
<li class="menu-item current">
<a href="/developers/basic/source-chain/">Source chain</a>
<ul>
  <li class="menu-item anchor">
    <a href="#recap" class="anchor">Recap</a>
  </li>
  <li class="menu-item anchor">
    <a href="#source-chain" class="anchor">Source chain</a>
  </li>
  <li class="menu-item anchor">
    <a href="#subconscious" class="anchor">Subconscious</a>
  </li>
  <li class="menu-item anchor">
    <a href="#happened-before" class="anchor">Happened before</a>
  </li>
</ul>

</li></ul>
</li>
<li class="menu-item">
<a href="/developers/intermediate/">Intermediate</a>
<ul><li class="menu-item">
<a href="/developers/intermediate/dht/">DHT</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/paths/">Paths</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/remote-call/">Remote Call</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/capability-tokens/">Capability Tokens</a>

</li></ul>
</li></ul>
  <div class="sidebar-bottom">
  <hr>
  <launch-dark-switch class="light-dark-switch" label="Toggle darkmode">Toggle darkmode</launch-dark-switch>


  <a href="https://github.com/holochain-gym/">Help and Feedback</a>
</div>

</rocket-navigation>

    
  </nav>
</rocket-drawer>

      
      
        <main class="markdown-body">
  
    <h1 id="basic-source-chain"><a class="anchor" href="#basic-source-chain"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Basic: Source chain</h1>
<h2 id="recap"><a class="anchor" href="#recap"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Recap</h2>
<p>You learned about entries and headers: two of the most basic building blocks in any holochain app. And experienced first hand, while solving the exercises, that hashes are the glue that holds everything together. We briefly mentioned something about hash tables and the DHT. You can learn more about the DHT <a href="/intermediate/DHT">here</a>.</p>
<h2 id="source-chain"><a class="anchor" href="#source-chain"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Source chain</h2>
<p>The Source chain. It sounds like something out of a scifi movie or a fantasy novel. And it is in fact a large part of what make holochain unique. It's where some of the magic happens.</p>
<p>The <a href="https://developer.holochain.org/docs/glossary/#source-chain">glossary</a> explains it the following way:</p>
<blockquote>
<p>A hash chain of elements committed by an agent. Every agent has a separate source chain for each of the cells they’re running, which stores all of the actions they’ve taken in that cell.</p>
</blockquote>
<p><em>Let's unpack this</em></p>
<p>When you download a compiled <a href="https://developer.holochain.org/docs/glossary/#dna">DNA</a>, a <a href="https://developer.holochain.org/docs/glossary/#webassembly-wasm">WASM</a> binary, from somewhere or when you compile it locally and you run this DNA in a holochain <a href="https://developer.holochain.org/docs/glossary/#conductor">conductor</a> that is running on your machine, then this DNA would be instantiated and linked to your <a href="https://developer.holochain.org/docs/glossary/#agent-id">agent ID</a>. That thing is a <a href="https://developer.holochain.org/docs/glossary/#cell">cell</a>.</p>
<p>If you want to keep things simple in your head, you can just say "when you run a DNA". A DNA can consist out of one or more zomes. All our exercises so far only contained one zome. The one you compiled from <code>zomes/exercise/lib.rs</code>. For the sake of simplicity we will keep on pretending every DNA has just one <a href="https://developer.holochain.org/docs/glossary/#zome">zome</a>. For now.</p>
<p>Now for the crucial part: "<strong>stores all of the actions</strong>". Every action, which in holochain speak means: every header and entry, that are produced by you, the agent, will become a part of the source chain, forever.
Whenever a new action is committed (creating entries or links, updating...) a new element is added to that chain, with its header referencing the previous one.
Essentially, the source-chain is a <strong>hash-chain of all the actions that a particular agent has committed in this DNA</strong>.</p>
<p>Perhaps this does sounds like some weird form of magic.
Head over to the simulation where you will see that, underneath, it is just a headers and entries.</p>
<h2 id="subconscious"><a class="anchor" href="#subconscious"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Subconscious</h2>
<p>Even before you add your first entries, like you did in the <a href="/basis/entries">entries exercise</a>, 3 headers and 1 entry will be created automatically in your holochain app. These 4 elements, the <a href="https://developer.holochain.org/docs/glossary/#genesis-elements">genesis events</a> are created by what you call the <strong>subconscious</strong> of your holochain app. When you talk about the subconscious of your holochain app, you are talking about all the entries, headers, DHT operations and validations that happen that are not actively, <em>consciously</em>, triggered by you, the user.</p>
<p>The 3 headers and 1 entry are created when the happ is installed, the moment when your DNA is instantiated into a cell. Click on the headers and the entry below to learn more about them.</p>
<mdjs-story mdjs-story-name="Sim0"></mdjs-story>
<ul>
<li>
<p><strong>DNA</strong> is a special type of header that marks the beginning of your source chain. In contrast to other headers it doesn't have a <code>header_seq</code> or a <code>prev_header</code> field, because it is the very first header in your holochain app. If a 1000 people run the same <a href="https://developer.holochain.org/docs/glossary/#dna">DNA</a> all of their holochain apps will have the same first header. And that is important, because that means you are, just like in real life, part of the same organism. In the world of holochain apps that means you share the same DHT through which you share data, through which you collaborate. <strong>Same DNA, same DHT. Different DNA, different DHT</strong></p>
</li>
<li>
<p><strong>AgentValidationPkg</strong> is important in deciding who is allowed to become part of the organism. It could be open access, as in, everyone with the same DNA can participate. But you can construct a <a href="https://developer.holochain.org/docs/glossary/#membrane">membrane</a> around your organism that controls who or under which conditions someone can participate. It is a very interesting part of a holochain app, but also a more advanced topic.</p>
</li>
<li>
<p><strong>Create header</strong> is just a simple header of type CREATE. The only special thing is that it points to an entry of type AGENT</p>
</li>
<li>
<p><strong>Agent entry</strong> or the <a href="https://developer.holochain.org/docs/glossary/#agent-id-entry">agent ID entry</a>, this entry contains the <a href="https://developer.holochain.org/docs/glossary/#agent-id">agent ID</a>, your public key. The agent ID is crucial in proving who you are to others cell in the organism, other people running the same DNA.</p>
</li>
</ul>
<p>You can think of the source chain as a blank notebook with page numbers. If you use it to record events, one event on one page, and you never skip a page, you are effectively using your notebook as a ledger. This gives your notebook some interesting properties. If you open a page on a specific event, you can find out what happened right before. And if you hand your notebook to someone, that someone can inspect your notebook to see if you removed a page or not, just by looking at the page numbers. The <code>prev_header</code> field in the headers acts like a page number. This is useful if another person is trying to validate if your notebook is telling the <em>complete</em> truth of what you wrote down in there.</p>
<h2 id="happened-before"><a class="anchor" href="#happened-before"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Happened before</h2>
<p><em>Let's put this in to practice</em></p>
<p>In the <a href="/basic/headers">headers exercise</a> you built the zome for a simple snacking logger app. The simulation below already contains your snacking logs.</p>
<ul>
<li>Click on all the entries (grey circles) to see what you snacked recently</li>
<li>Click on the headers (rounded blue squares) and look at <code>hash</code> in the header and at the <code>prev_header</code> value. Notice how they form a <strong>flawless chain</strong>, all the way down to the DNA header.</li>
<li>Select "register_snacking" in the CallZomeFns below, type <code>april 3: ice cream</code> in the input and click <em>EXECUTE</em>. You will see that the new header is added at the end of the chain. It is impossible to insert something in the middle of your chain. That would break your chain and make it invalid. So regardless of any dates or timestamp in the entry or header, a new header will always added at the end. Your source chain is <strong>append only</strong>. You can never hide the fact that you ate lemon pie on april 2nd. And you cannot deny that you logged <code>april 3: ice cream</code> after you logged <code>april 5: marsmallows</code>.</li>
<li>Select "say_greeting" in the CallZomeFns below, type <code>Hello world</code> in the input and click <em>EXECUTE</em>. Your source chain can contain any entry type that you defined in your zomes. It does not matter if your entries are a snacking_log, a greeting_text or anything else. You can <strong>mix entries of different types</strong>, the headers will always appear in your source chain in the same order as they were created.</li>
</ul>
<mdjs-story mdjs-story-name="Sim1"></mdjs-story>
<p>This time we will do some lightweight exercises, just to get a feel for the chain part of our source chain. You need to implement 3 functions.</p>
<ul>
<li><code>is_previous_header_hash</code> if you give your zome 2 hashes, it will answer if the second header hash is the previous, a direct parent, of the first header hash.</li>
<li><code>happened_before</code> does the same as the above function, but it is not limited to the direct parent. I will determine is the second hash is an ancestor. So it is not limited to the direct parent.</li>
<li><code>get_header_sequence_number</code> the header contains a field header_seq, which contains the sequence number of the header in the chain. The very first header, the DNA header, does not have this field. You could say it is implicitly zero. The next header starts counting at one. Umagine your UI is loading all the headers to show. In that case it can come in handy if you have an idea of where in the chain you are.</li>
</ul>
<inline-notification type="tip" title="Exercise">
<ol>
<li>Check if you are still inside the nix-shell<br>
<em>Your terminal should similar to this</em> <code>[nix-shell:~/path-to-workspace/developer-exercises/path-to-exercise]$</code></li>
<li>Implement <code>is_previous_header_hash</code>, <code>happened_before</code>, <code>get_header_sequence_number</code></li>
<li>Compile your code: <code>./run_build.sh</code></li>
<li>Run the test: <code>./run_tests.sh</code></li>
<li>Don't stop until the tests run green</li>
</ol>
</inline-notification>
<h1 id="errors"><a class="anchor" href="#errors"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Errors</h1>
<p>If you encounter an error check here if you can find something that looks like your error. If not head to the <a href="https://forum.holochain.org/t/gym-help-needed-offer-request/4622/15">forum.holochain.org</a> and ask for help.</p>
<p><em>Nothing added for now</em></p>
<p>For Rust specific questions:
<a href="https://forum.holochain.org/c/technical/rust/15">https://forum.holochain.org/c/technical/rust/15</a>
or
your favorite search engine</p>
        
      

  
    <div class="content-footer">
  <p>
    Caught a mistake or want to contribute to the documentation?
    <a href="https://github.com/holochain-gym/holochain-gym.github.io/edit/master/./docs/developers/basic/source-chain.md">Edit this page on GitHub!</a>
  </p>
</div>

  
</main>

      
    </div>
  </div>


    
      <footer id="main-footer">
  
    

  
    <div id="footer-menu">
  <div class="content-area">
    
      <nav>
        <h3>Holochain</h3>
        <ul>
          
            <li>
              <a href="https://developer.holochain.org/docs/references/">Documentation</a>
            </li>
          
            <li>
              <a href="https://forum.holochain.org">Forum</a>
            </li>
          
        </ul>
      </nav>
    
      <nav>
        <h3>Gym</h3>
        <ul>
          
            <li>
              <a href="https://forum.holochain.org/c/learning-library/gym/133">Help and Feedback</a>
            </li>
          
            <li>
              <a href="https://github.com/holochain-gym/holochain.github.io/issues">Tasks for Contributors to the Gym</a>
            </li>
          
        </ul>
      </nav>
    
      <nav>
        <h3>Discover</h3>
        <ul>
          
            <li>
              <a href="https://holochain-open-dev.github.io/blog">Holochain Open Dev Blog</a>
            </li>
          
            <li>
              <a href="https://github.com/holochain-open-dev">Open Source Modules</a>
            </li>
          
        </ul>
      </nav>
    
      <nav>
        <h3>License</h3>
        <ul>
          
            <li>
              <a href="http://creativecommons.org/licenses/by/4.0/">This work is licensed under</a>
            </li>
          
            <li>
              <a href="http://creativecommons.org/licenses/by/4.0/">a Creative 
Commons Attribution 4.0</a>
            </li>
          
            <li>
              <a href="http://creativecommons.org/licenses/by/4.0/">International License</a>
            </li>
          
        </ul>
      </nav>
    
  </div>
</div>

  
</footer>

    

    
  



  <script>
  async function serviceWorkerUpdate() {
  if ('serviceWorker' in navigator) {
    const oldReg = await navigator.serviceWorker.getRegistration();
    let oldSwState;
    if (oldReg && oldReg.active) {
      oldSwState = oldReg.active.state;
    }

    let refreshing;

    navigator.serviceWorker.addEventListener('controllerchange', async () => {
      if (refreshing) {
        return;
      }

      const newReg = await navigator.serviceWorker.getRegistration();
      let newSwState;
      if (newReg && newReg.active) {
        newSwState = newReg.active.state;
      }

      if (oldSwState === 'activated' && newSwState === 'activating') {
        refreshing = true;
        window.location.reload();
      }
    });
  }
}

serviceWorkerUpdate();

</script>


  



  

<script inject-service-worker="">
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker
          .register('../../../service-worker.js')
          .then(function() {
            console.log('ServiceWorker registered from "../../../service-worker.js".');
          })
          .catch(function(err) {
            console.log('ServiceWorker registration failed: ', err);
          });
      });
    }
  </script>
<script type="module" src="../../../da0cf761.js"></script>
<script type="module" src="../../../3290032f7.js"></script>

</body></html>